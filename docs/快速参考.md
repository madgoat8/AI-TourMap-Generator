# 🚀 模型下载快速参考

## 一键下载
```bash
# Windows 用户
download_models.bat

# Linux/Mac 用户  
python download_models.py
```

## 镜像配置
```bash
# 自动选择最佳镜像
python setup_mirror.py auto

# 手动设置镜像
python setup_mirror.py hf-mirror    # 国内优化 (推荐)
python setup_mirror.py modelscope   # 阿里云镜像
python setup_mirror.py official     # 官方源

# 测试镜像连通性
python setup_mirror.py test
```

## 常见问题
| 问题 | 解决方案 |
|------|---------|
| 网络超时 | `python setup_mirror.py auto` |
| 代理冲突 | 清除代理: `set http_proxy=` |
| 磁盘不足 | 清理缓存: `rm -rf model_cache/` |
| 权限错误 | `chmod 755 ./model_cache` |

## 模型大小
- **总计**: ~8.9GB
- ControlNet: ~1.2GB
- Stable Diffusion: ~4.2GB  
- IP-Adapter: ~1.8GB
- CLIP: ~1.7GB

## 验证下载
```bash
# 检查缓存大小
python -c "import os; print(f'{sum(os.path.getsize(os.path.join(r,f)) for r,d,fs in os.walk(\"model_cache\") for f in fs)/(1024**3):.1f}GB')"

# 测试模型加载
python -c "from diffusers import ControlNetModel; print('✅ OK' if ControlNetModel.from_pretrained('lllyasviel/sd-controlnet-canny', cache_dir='./model_cache', local_files_only=True) else '❌ Fail')"
```

## 离线启动
```bash
start_offline.bat        # Windows
python start_offline.py  # Linux/Mac
```