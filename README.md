# AIç”Ÿæˆå¯¼è§ˆæ‰‹ç»˜å›¾

åŸºäºAIæŠ€æœ¯çš„åœ°å›¾æ‰‹ç»˜é£æ ¼è½¬æ¢å·¥å…·ï¼Œå°†çœŸå®åœ°ç†æ•°æ®è½¬æ¢ä¸ºè‰ºæœ¯åŒ–çš„æ‰‹ç»˜å¯¼è§ˆå›¾ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸ—ºï¸ æ”¯æŒä»»æ„åŒºåŸŸåœ°å›¾é€‰æ‹©
- ğŸ¨ AIé©±åŠ¨çš„æ‰‹ç»˜é£æ ¼è½¬æ¢
- ğŸ“ åŸºäºçœŸå®OSMåœ°ç†æ•°æ®
- ğŸ–¼ï¸ å®æ—¶é¢„è§ˆå’Œé€æ˜åº¦è°ƒèŠ‚
- ğŸŒ ä½¿ç”¨å¤©åœ°å›¾ç“¦ç‰‡æœåŠ¡

## æ ¸å¿ƒç”Ÿæˆæµç¨‹

1. **å‰ç«¯é€‰åŒº** â†’ ç”¨æˆ·åœ¨åœ°å›¾ä¸Šé€‰æ‹©åŒºåŸŸï¼Œè·å–ç»çº¬åº¦åæ ‡
2. ç”Ÿæˆå«æ˜Ÿå›¾ â†’ åç«¯æ ¹æ®ç»çº¬åº¦åæ ‡,ä½¿ç”¨æœ€å¤§ç¼©æ”¾,è¯·æ±‚æ‹¼æ¥ç“¦ç‰‡è£å‰ª,ç”Ÿæˆæ¡†é€‰èŒƒå›´çš„é«˜æ¸…å«æ˜Ÿå›¾
3. **OSMæ•°æ®è·å–** â†’ åç«¯é€šè¿‡Overpass APIæŸ¥è¯¢è¯¥åŒºåŸŸçš„åœ°ç†æ•°æ®ï¼ˆå»ºç­‘ã€é“è·¯ã€æ°´ä½“ã€ç»¿åœ°ç­‰ï¼‰
4. **è¯­ä¹‰åœ°å›¾ç”Ÿæˆ** â†’ å°†OSMæ•°æ®è½¬æ¢ä¸ºå½©è‰²è¯­ä¹‰å›¾ï¼ˆç»¿è‰²=å…¬å›­ï¼Œçº¢è‰²=æ°´ä½“ï¼Œæ©™è‰²=å»ºç­‘/é“è·¯ï¼‰
5. **Cannyè¾¹ç¼˜æ£€æµ‹** â†’ å¯¹è¯­ä¹‰å›¾è¿›è¡Œç°åº¦è½¬æ¢ï¼Œæå–è¾¹ç¼˜è½®å»“ä½œä¸ºç»“æ„æ§åˆ¶å›¾
6. **ControlNetç»“æ„æ§åˆ¶** â†’ ä½¿ç”¨Cannyè½®å»“å›¾ä¸¥æ ¼æ§åˆ¶ç”Ÿæˆå†…å®¹çš„ç©ºé—´å¸ƒå±€å’Œç»“æ„
7. **Stable Diffusionç”Ÿæˆ** â†’ æ ¹æ®ä¼˜åŒ–åçš„æç¤ºè¯ï¼ˆå¼ºè°ƒå¿ å®åŸå§‹æ•°æ®ï¼‰+ ControlNetçº¦æŸ + å¯é€‰çš„IP-Adapteré£æ ¼è¿ç§»ï¼Œç”Ÿæˆæ‰‹ç»˜é£æ ¼åœ°å›¾
8. POIè°ƒæ•´ä¼˜åŒ– â†’ å‰ç«¯ç•Œé¢æ ‡è¯†å…³é”®POIä¿¡æ¯å’Œç±»å‹,æäº¤åç«¯æ¨¡å‹é‡æ–°å±€éƒ¨é‡ç»˜
9. **ç»“æœè¿”å›** â†’ å°†ç”Ÿæˆçš„æ‰‹ç»˜å›¾å åŠ åˆ°åŸåœ°å›¾åŒºåŸŸ

### æ ¸å¿ƒæµç¨‹å›¾

```mermaid
graph TD
    A[ç”¨æˆ·é€‰æ‹©åœ°å›¾åŒºåŸŸ] --> B[å‰ç«¯å‘é€åæ ‡åˆ°åç«¯];
    B --> C[åç«¯åˆ›å»ºç”Ÿæˆä»»åŠ¡];
    C --> D[å¼‚æ­¥å¤„ç†å¼€å§‹];
    
    subgraph "åå°AIå¤„ç†æµç¨‹"
        D --> E[è·å–OSMåœ°ç†æ•°æ®];
        E --> F[ç”Ÿæˆè¯­ä¹‰åˆ†å‰²å›¾];
        F --> G[æå–è¾¹ç¼˜æ§åˆ¶å›¾];
        G --> H[åŠ è½½AIæ¨¡å‹å’Œé£æ ¼å‚è€ƒ];
        H --> I[è¿è¡ŒAI Pipelineç”Ÿæˆæ‰‹ç»˜å›¾];
        I --> J[ç¼–ç ç»“æœå¹¶å­˜å‚¨];
    end
    
    J --> K[å‰ç«¯è½®è¯¢ä»»åŠ¡çŠ¶æ€];
    K --> L{ç”Ÿæˆæ˜¯å¦æˆåŠŸ?};
    L -- æˆåŠŸ --> M[è·å–ç”Ÿæˆçš„æ‰‹ç»˜å›¾];
    L -- å¤±è´¥ --> N[è®°å½•é”™è¯¯å¹¶æç¤ºç”¨æˆ·];
    M --> O[å åŠ æ˜¾ç¤ºåˆ°åœ°å›¾ä¸Š];
    O --> P{ç”¨æˆ·æ˜¯å¦éœ€è¦è°ƒæ•´POI?};
    P -- éœ€è¦ --> Q[ç”¨æˆ·æ‰‹åŠ¨è°ƒæ•´POIä¿¡æ¯];
    Q --> R[æäº¤POIè°ƒæ•´è¯·æ±‚];
    R --> S[åç«¯å±€éƒ¨é‡ç»˜å¤„ç†];
    S --> T[æ›´æ–°æ‰‹ç»˜å›¾æ˜¾ç¤º];
    P -- ä¸éœ€è¦ --> U[æµç¨‹ç»“æŸ];
    T --> U;
    
    style A fill:#e1f5fe
    style B fill:#e1f5fe
    style C fill:#e1f5fe
    style D fill:#e1f5fe
    style E fill:#f3e5f5
    style F fill:#f3e5f5
    style G fill:#f3e5f5
    style H fill:#f3e5f5
    style I fill:#f3e5f5
    style J fill:#f3e5f5
    style K fill:#e8f5e8
    style L fill:#e8f5e8
    style M fill:#e8f5e8
    style N fill:#ffebee
    style O fill:#e8f5e8
    style P fill:#fff3e0
    style Q fill:#fff3e0
    style R fill:#fff3e0
    style S fill:#fff3e0
    style T fill:#fff3e0
    style U fill:#e0f2f1
```

### å…³é”®ä¼˜åŒ–ç‚¹

- ControlNetç¡®ä¿ç»“æ„å‡†ç¡®æ€§ï¼ˆcontrolnet_conditioning_scale=1.2ï¼‰
- è´Ÿé¢æç¤ºè¯é˜²æ­¢"æ— ä¸­ç”Ÿæœ‰"
- é™ä½guidance_scaleå‡å°‘è¿‡åº¦ç”Ÿæˆ

è¿™æ ·æ—¢ä¿è¯äº†åœ°ç†å‡†ç¡®æ€§ï¼Œåˆå®ç°äº†è‰ºæœ¯åŒ–çš„æ‰‹ç»˜æ•ˆæœã€‚

## æŠ€æœ¯æ ˆ

- **å‰ç«¯**: HTML5 + Leaflet.js + å¤©åœ°å›¾API
- **åç«¯**: FastAPI + Python
- **AIæ¨¡å‹**: Stable Diffusion + ControlNet + IP-Adapter
- **æ•°æ®æº**: OpenStreetMap (OSM) + Overpass API
- **GPUåŠ é€Ÿ**: CUDA + xFormersä¼˜åŒ–

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.8+
- CUDAæ”¯æŒçš„GPUï¼ˆæ¨èï¼‰
- 8GB+ GPUæ˜¾å­˜

### å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### è¿è¡ŒæœåŠ¡

```bash
# GPUç‰ˆæœ¬ï¼ˆæ¨èï¼‰
python main_gpu.py

# æˆ–ä½¿ç”¨æ‰¹å¤„ç†æ–‡ä»¶
start_gpu.bat
```

### è®¿é—®åº”ç”¨

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://127.0.0.1:8003

## ä½¿ç”¨è¯´æ˜

1. ç‚¹å‡»"é€‰æ‹©åŒºåŸŸ"æŒ‰é’®
2. åœ¨åœ°å›¾ä¸Šæ‹–æ‹½é€‰æ‹©è¦ç”Ÿæˆæ‰‹ç»˜å›¾çš„åŒºåŸŸ
3. ç‚¹å‡»"ç”Ÿæˆæ‰‹ç»˜åœ°å›¾"å¼€å§‹AIå¤„ç†
4. ç­‰å¾…ç”Ÿæˆå®Œæˆï¼Œå¯è°ƒèŠ‚é€æ˜åº¦æŸ¥çœ‹æ•ˆæœ

## é…ç½®è¯´æ˜

### å¤©åœ°å›¾APIå¯†é’¥

éœ€è¦åœ¨ `index.html` ä¸­æ›¿æ¢ `YOUR_API_KEY` ä¸ºæ‚¨çš„å¤©åœ°å›¾APIå¯†é’¥ï¼š

```javascript
// åœ¨å¤©åœ°å›¾å®˜ç½‘ç”³è¯·å…è´¹APIå¯†é’¥
const apiKey = "YOUR_API_KEY";
```

### GPUä¼˜åŒ–è®¾ç½®

ç¨‹åºä¼šè‡ªåŠ¨æ£€æµ‹GPUå¹¶å¯ç”¨ä»¥ä¸‹ä¼˜åŒ–ï¼š

- Float16ç²¾åº¦æ¨ç†
- æ³¨æ„åŠ›åˆ‡ç‰‡ä¼˜åŒ–
- xFormerså†…å­˜é«˜æ•ˆæ³¨æ„åŠ›
- VAEåˆ‡ç‰‡å’Œå¹³é“ºä¼˜åŒ–

## é¡¹ç›®ç»“æ„

```
AI-TourMap-Generator/
â”œâ”€â”€ index.html          # å‰ç«¯ç•Œé¢
â”œâ”€â”€ main_gpu.py         # GPUä¼˜åŒ–ç‰ˆåç«¯æœåŠ¡
â”œâ”€â”€ start_gpu.bat       # Windowså¯åŠ¨è„šæœ¬
â”œâ”€â”€ requirements.txt    # Pythonä¾èµ–
â”œâ”€â”€ model_cache/        # AIæ¨¡å‹ç¼“å­˜ç›®å½•
â”œâ”€â”€ debug_runs/         # è°ƒè¯•è¾“å‡ºç›®å½•
â””â”€â”€ generation_gpu.log  # è¿è¡Œæ—¥å¿—
```

## è®¸å¯è¯

MIT License
